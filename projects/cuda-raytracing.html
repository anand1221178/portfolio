<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="GPU-Accelerated Ray Tracer with CUDA - Achieving 187M rays/sec with optimized memory hierarchy.">
    <meta name="theme-color" content="#0a0a0b">
    <title>GPU-Accelerated Ray Tracer | Anand Patel</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/project.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body>
    <nav class="nav">
        <div class="nav-inner">
            <a href="../index.html" class="nav-logo">Anand<span>.</span></a>
            <div class="nav-links">
                <a href="../index.html#about">About</a>
                <a href="../index.html#projects">Projects</a>
                <a href="../index.html#contact">Contact</a>
            </div>
            <button class="nav-toggle" id="navToggle" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <a href="../index.html#about">About</a>
        <a href="../index.html#projects">Projects</a>
        <a href="../index.html#contact">Contact</a>
    </div>

    <section class="project-hero">
        <div class="container">
            <div class="breadcrumb">
                <a href="../index.html">Home</a>
                <i class="fas fa-chevron-right"></i>
                <a href="../index.html#projects">Projects</a>
                <i class="fas fa-chevron-right"></i>
                <span>GPU-Accelerated Ray Tracer</span>
            </div>
            <h1 class="project-title">GPU-Accelerated Ray Tracer with CUDA</h1>
            <div class="project-meta">
                <span><i class="fas fa-calendar"></i> 2024-2025</span>
                <span><i class="fas fa-tag"></i> High Performance Computing, Graphics</span>
                <span><i class="fas fa-clock"></i> 8 min read</span>
            </div>
        </div>
    </section>

    <section class="project-content">
        <div class="container">
            <div class="content-grid">
                <aside class="project-sidebar">
                    <div class="sidebar-section">
                        <h3>Technologies Used</h3>
                        <div class="tech-stack">
                            <span class="tech-item">C++</span>
                            <span class="tech-item">CUDA</span>
                            <span class="tech-item">Physically-Based Rendering</span>
                            <span class="tech-item">GPU Programming</span>
                        </div>
                    </div>
                    <div class="sidebar-section">
                        <h3>Quick Stats</h3>
                        <div class="project-stats">
                            <div class="stat">
                                <span class="stat-value">187M</span>
                                <span class="stat-label">Rays/sec</span>
                            </div>
                            <div class="stat">
                                <span class="stat-value">14B</span>
                                <span class="stat-label">Rays/Frame</span>
                            </div>
                            <div class="stat">
                                <span class="stat-value">1080p</span>
                                <span class="stat-label">Resolution</span>
                            </div>
                        </div>
                    </div>
                    <div class="sidebar-section">
                        <h3>Links</h3>
                        <div class="project-links">
                            <a href="https://github.com/anand1221178/Cuda-Raytracing" class="project-link" target="_blank">
                                <i class="fab fa-github"></i> View on GitHub
                            </a>
                            <a href="cuda-raytracing-report.pdf" class="project-link" target="_blank">
                                <i class="fas fa-file-pdf"></i> Technical Report
                            </a>
                        </div>
                    </div>
                </aside>

                <main class="project-main">
                    <div class="project-overview">
                        <h2>Project Overview</h2>
                        <p>
                            This project implements a GPU-accelerated ray tracer using NVIDIA CUDA, achieving a peak performance
                            of 187.4 million rays per second. The system renders a 1080p image with 300 samples per pixel by tracing
                            14 billion rays, demonstrating the massive parallelism of GPUs for graphics workloads.
                        </p>
                        <p>
                            A key focus of the project was memory hierarchy optimization. Through a systematic comparison of global,
                            constant, and texture memory, it was found that global memory outperformed constant memory by 29%.
                            This surprising result revealed that the workload is memory latency-bound rather than bandwidth-bound,
                            a critical insight for GPU optimization.
                        </p>
                    </div>

                    <div class="project-section">
                        <h2>Key Features</h2>
                        <div class="feature-grid">
                            <div class="feature-card">
                                <i class="fas fa-microchip"></i>
                                <h3>CUDA Kernel Optimization</h3>
                                <p>Highly optimized kernels designed for maximum parallelism and memory throughput.</p>
                            </div>
                            <div class="feature-card">
                                <i class="fas fa-bolt"></i>
                                <h3>High Performance</h3>
                                <p>Achieves 187.4 million rays per second through efficient GPU utilization.</p>
                            </div>
                            <div class="feature-card">
                                <i class="fas fa-sun"></i>
                                <h3>Physically-Based Rendering</h3>
                                <p>Accurate light transport simulation for realistic image generation.</p>
                            </div>
                            <div class="feature-card">
                                <i class="fas fa-layer-group"></i>
                                <h3>BVH Acceleration</h3>
                                <p>Bounding Volume Hierarchy for efficient ray-scene intersection, enabling complex scenes.</p>
                            </div>
                        </div>
                    </div>

                    <div class="project-section">
                        <h2>Technical Implementation</h2>

                        <h3>1. Parallel Ray Generation</h3>
                        <p>
                            Each pixel in the output image is processed by a separate CUDA thread, which generates and traces
                            multiple rays for anti-aliasing and Monte Carlo sampling. This embarrassingly parallel approach
                            is a perfect fit for the GPU's architecture.
                        </p>
                        <pre><code class="language-cpp">// From cuda_kernels.cu
__global__ void raytrace_kernel(...) {
    int x = blockIdx.x * blockDim.x + threadIdx.x;
    int y = blockIdx.y * blockDim.y + threadIdx.y;

    if (x >= width || y >= height) return;

    // ... ray generation and tracing logic ...
}</code></pre>

                        <h3>2. BVH Construction and Traversal</h3>
                        <p>
                            A Bounding Volume Hierarchy (BVH) is constructed on the CPU and transferred to the GPU to accelerate
                            ray-scene intersections. The BVH traversal is performed in the CUDA kernel, dramatically reducing
                            the number of ray-primitive intersection tests.
                        </p>
                        <pre><code class="language-cpp">// From cuda_kernels.cu
__device__ bool intersect_bvh(...) {
    // ... BVH traversal logic ...
}</code></pre>

                        <h3>3. Memory Hierarchy Analysis</h3>
                        <p>
                            A systematic comparison of three memory configurations for storing scene geometry was performed:
                        </p>
                        <ul class="improvement-list">
                            <li><strong>Global Memory (187.4M rays/sec):</strong> The best performing configuration due to effective L1/L2 cache utilization.</li>
                            <li><strong>Constant Memory (144.9M rays/sec):</strong> 29% slower. The broadcast mechanism of constant memory is ineffective for divergent ray access patterns.</li>
                            <li><strong>Texture Memory (165.2M rays/sec):</strong> 13% slower. The hardware interpolation and address calculation overhead is not beneficial for this workload.</li>
                        </ul>
                        <p>
                            <strong>Key Finding:</strong> The ray tracing workload is <strong>memory latency-bound</strong>, not bandwidth-bound. This makes the cache hierarchy crucial for performance, leading to global memory's superiority.
                        </p>
                    </div>

                    <div class="project-section">
                        <h2>Performance Analysis and Insights</h2>
                        <div class="challenge-list">
                            <div class="challenge-item">
                                <h3><i class="fas fa-tachometer-alt"></i> Memory Latency Bottleneck</h3>
                                <p>
                                    <strong>Discovery:</strong> Global memory outperformed constant memory by 29%, which was unexpected for read-only data.
                                </p>
                                <p>
                                    <strong>Root Cause:</strong> Ray tracing exhibits highly divergent memory access. Constant memory's broadcast optimization fails when threads in a warp access different data, serializing memory access. Global memory's L1/L2 cache hierarchy is better at handling these irregular access patterns.
                                </p>
                            </div>
                            <div class="challenge-item">
                                <h3><i class="fas fa-project-diagram"></i> Texture Memory Overhead</h3>
                                <p>
                                    Texture memory was 13% slower than global memory. The hardware interpolation and address calculation features of texture memory, which are beneficial for tasks like texture mapping, introduced overhead for the exact geometric lookups required in ray tracing.
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="project-section">
                        <h2>Conclusion</h2>
                        <p>
                            This project successfully implemented a high-performance GPU-accelerated ray tracer, achieving 187.4 million rays per second. The key insight from this project was the counterintuitive finding that global memory, with its L1/L2 cache, is the optimal choice for storing scene geometry in a ray tracer with divergent access patterns. This highlights the importance of empirical profiling over relying on conventional wisdom in GPU optimization.
                        </p>
                    </div>

                    <div class="navigation-buttons">
                        <a href="aircraft-fault-detection.html" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Previous Project
                        </a>
                        <a href="quadruped-rl.html" class="btn btn-primary">
                            Next Project <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </main>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="footer-inner">
            <p>&copy; 2025 Anand Patel. All rights reserved.</p>
            <div class="footer-links">
                <a href="https://github.com/anand1221178" target="_blank" aria-label="GitHub">
                    <i class="fab fa-github"></i>
                </a>
                <a href="https://linkedin.com/in/anand-patel1221" target="_blank" aria-label="LinkedIn">
                    <i class="fab fa-linkedin"></i>
                </a>
                <a href="mailto:anandpatel1221178@gmail.com" aria-label="Email">
                    <i class="fas fa-envelope"></i>
                </a>
            </div>
        </div>
    </footer>

    <script src="../js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js"></script>
</body>
</html>
